<p *ngIf="!highlights">Loading...</p>

<div *ngIf="highlights" #highlightsChain class="highlights-chain">
    <div class="highlights-chain_container" *ngFor="let highlight of highlights; index as i">
        <ng-container [ngSwitch]="highlight.type" class="card-body_details">
            <app-highlight
                [id]="highlight.id"
                *ngSwitchCase="highlightType.place"
                [highlight]="highlight"
                class="highlights-chain_highlight highlights-chain_highlight--place"
                [ngClass]="{
                    'highlights-chain_highlight--left': highlightAlignments[i] === alignmentType.left,
                    'highlights-chain_highlight--right': highlightAlignments[i] === alignmentType.right
                }"
            ></app-highlight>
            <div
                *ngSwitchCase="highlightType.section"
                class="section-highlight"
                [ngClass]="{ expanded: expandedSectionHighlightIds.includes(highlight.id) }"
            >
                <div
                    class="section-highlight_background"
                    [ngClass]="{ resizing: resizingSectionHighlightIds.includes(highlight.id) }"
                ></div>

                <div
                    class="section-highlight_info"
                    [ngClass]="{
                        'section-highlight_info--left': highlightAlignments[i] === alignmentType.rightIncoming,
                        'section-highlight_info--right': highlightAlignments[i] === alignmentType.leftIncoming
                    }"
                >
                    <span class="section-highlight_info-title">{{ highlight.title }}</span>
                    <img class="section-highlight_info-icon" src="../../../../../assets/icons/icon.png" />
                </div>
                <app-highlight
                    *ngFor="let child of highlight.children"
                    class="highlights-chain_highlight in-section"
                    [ngClass]="{
                        'highlights-chain_highlight--left': highlightAlignments[i] === alignmentType.leftIncoming,
                        'highlights-chain_highlight--right': highlightAlignments[i] === alignmentType.rightIncoming
                    }"
                    [highlight]="child"
                    [id]="child.id"
                    [inSection]="true"
                    (expansion)="trackHighlightExpansion($event)"
                ></app-highlight>
            </div>
        </ng-container>
        <div
            class="highlights-chain_connector"
            [ngClass]="{
                'highlights-chain_connector--left': highlightAlignments[i] === alignmentType.left,
                'highlights-chain_connector--right': highlightAlignments[i] === alignmentType.right,
                'highlights-chain_connector--left-incoming': highlightAlignments[i] === alignmentType.leftIncoming,
                'highlights-chain_connector--right-incoming': highlightAlignments[i] === alignmentType.rightIncoming
            }"
        ></div>
    </div>
</div>
