<p *ngIf="!highlights">Loading...</p>

<div *ngIf="highlights" #highlightsChain class="highlights-chain">
    <div class="highlights-chain_container" *ngFor="let highlight of highlights; index as i">
        <ng-container [ngSwitch]="highlight.type">
            <app-highlight
                [id]="highlight.id"
                *ngSwitchCase="highlightType.place"
                [highlight]="highlight"
                class="place-highlight"
                [ngClass]="{
                    left: highlightAlignments[i] === alignmentType.left,
                    right: highlightAlignments[i] === alignmentType.right
                }"
            ></app-highlight>
            <div *ngSwitchCase="highlightType.section" class="section-highlight">
                <div
                    class="section-highlight_background"
                    [ngClass]="{
                        resizing: resizingSectionHighlightIds.includes(highlight.id),
                        expanded: expandedSectionHighlightIds.includes(highlight.id)
                    }"
                ></div>
                <div
                    class="section-highlight_info"
                    [ngClass]="{
                        hidden: expandedSectionHighlightIds.includes(highlight.id) || resizingSectionHighlightIds.includes(highlight.id),
                        left: highlightAlignments[i] === alignmentType.rightIncoming,
                        right: highlightAlignments[i] === alignmentType.leftIncoming,
                        'card-width': highlight.children.length === 0
                    }"
                >
                    <span class="section-highlight_info-title">{{ highlight.title }}</span>
                    <svg class="section-highlight_info-icon">
                        <use xlink:href="../../../../assets/icons/icon.svg#icon-dots" />
                    </svg>
                </div>
                <app-highlight
                    *ngFor="let child of highlight.children"
                    class="place-highlight in-section"
                    [ngClass]="{
                        left: highlightAlignments[i] === alignmentType.leftIncoming,
                        right: highlightAlignments[i] === alignmentType.rightIncoming
                    }"
                    [highlight]="child"
                    [id]="child.id"
                    [inSection]="true"
                    (expansion)="trackHighlightExpansion($event)"
                ></app-highlight>
            </div>
        </ng-container>
        <div
            class="connector"
            [ngClass]="{
                left: highlightAlignments[i] === alignmentType.left,
                right: highlightAlignments[i] === alignmentType.right,
                'left-incoming': highlightAlignments[i] === alignmentType.leftIncoming,
                'right-incoming': highlightAlignments[i] === alignmentType.rightIncoming
            }"
        ></div>
    </div>
</div>
